<html>
  <head>
    <link rel="stylesheet" type="text/css" href="style.css" media="screen" />
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery-csv/0.71/jquery.csv-0.71.min.js"></script>
    <script type="text/javascript">
    
    var url_string = window.location.href
    var url = new URL(url_string);
    var m = url.searchParams.get("m");

    var arrTableData;
    loadData(m);

    google.charts.load('current', {'packages':['table']});
    google.charts.setOnLoadCallback(drawTable);
        
    function loadData(month) {
        arrTableData = [];
        $.ajax({
            async: false,
            type: "GET",  
            url: "./data/"+month+"/top5_group_change.csv",
            dataType: "text",       
            success: function(response) {
                var arrDataTemp = $.csv.toArrays(response);
                for(var i=1; i<arrDataTemp.length; i++) {
                    group_name = arrDataTemp[i][0];
                    last_month_weight = parseFloat(arrDataTemp[i][1]*100);
                    this_month_weight = parseFloat(arrDataTemp[i][2]*100);
                    changed_weight = parseFloat(arrDataTemp[i][3]*100);
                    //alert(group_weight);
                    arrTableData.push([group_name,last_month_weight,this_month_weight,changed_weight]);
                } 
            }   
        });
    }
        
    function drawTable() {
        var data = new google.visualization.DataTable();
        data.addColumn('string', 'ETF Group');
        data.addColumn('number', 'Last Month Weight(%)');
        data.addColumn('number', 'This Month Weight(%)');
        data.addColumn('number', 'Changed Weight(%)');
        data.addRows(arrTableData);
        var options = {
            showRowNumber: true,
            width: 800,
            height: 400
        }
        var table = new google.visualization.Table(document.getElementById('table_div'));
        table.draw(data, options);
    }   
    </script>
  </head>

  <body>
    <div id='custom-title'>- ETF Investment Profolio -</div>
    <div class="space"></div>
    <div class="custom-head" id="weight"><h3>Group Changed Weight</h3></div>
    <div id="table_div"></div>
  </body>
  <script type="text/javascript">
    var url_string = window.location.href
    var url = new URL(url_string);
    var m = url.searchParams.get("m");
    var e = document.getElementById('weight');
    e.innerHTML = 'Group Changed Weight ('+m+')';   
  </script> 
</html>